A. 自私挖矿攻击
自私挖矿是一种在基于工作量证明（PoW）的区块链系统中的颠覆性策略[52]，其中攻击者，即恶意矿工或矿池，可能不会广播新挖出的区块，而是选择（i）保留区块或（ii）持有并在适当的时候释放区块。在这种情况下，诚实的矿工在寻找已经发现的区块时浪费了他们的计算能力，而恶意矿工因此增加了他们发现下一个区块的概率。矿池区块保留（PBWH）攻击是自私挖矿攻击的一种常见形式[53]。在PBWH攻击中，攻击矿池渗透到被攻击的矿池中，渗透的矿工执行区块保留（BWH）攻击，即保留被攻击矿池中新发现的全部区块。为了防止这种攻击，分析矿工和矿池的策略以及他们之间的互动至关重要。马尔可夫决策过程（MDP）[54]可以用来分析个体玩家，即矿工或矿池的策略和效用。然而，MDP没有考虑到多个玩家之间的互动。相比之下，博弈论可以有效地应用。

![image-20240602172612929](C:/Users/daijunhao/AppData/Roaming/Typora/typora-user-images/image-20240602172612929.png)

在[35]中，作者采用非合作博弈来分析矿池之间的互动。这种情况在图4中以两个自私矿池作为玩家进行了说明。每个玩家的策略是确定其渗透率，即用于执行渗透的计算能力的比例。在攻击情况下，攻击矿池不仅从其诚实矿工那里获得效用，还从在受攻击矿池内执行BWH攻击的渗透矿工那里获得效用。玩家的目标是优化其渗透率，从而最大化其效用。特别是，玩家的效用是计算能力和渗透率的函数。通过使用关于渗透率的二阶导数，证明了效用函数是凹的。因此，存在一个唯一的纳什均衡，其中没有玩家可以通过改变其策略（即渗透率）来提高自己的效用。在均衡点，渗透率总是大于零。这意味着发起PBWH攻击始终是每个玩家的最佳回应。模拟结果表明，只有当矿池控制了总计算能力的严格多数时，矿池才能通过发起PBWH攻击来提高其效用。然而，在两个矿池相互攻击的情况下，每个矿池的效用低于两个矿池都不攻击的情况。

[35]中的情况类似于博弈论中著名的囚徒困境[12]，导致矿工的效用损失。为了避免矿工的困境，矿工可以选择以下解决方案之一。第一种解决方案是矿工有意加入不会涉及PWH攻击的私有矿池。结果，大型矿池可能会自发地分成许多小矿池，最终这可能会为整个比特币系统带来更好的环境。第二种解决方案是矿工执行所谓的零决定性（ZD）策略[68]。这一解决方案在[50]中提出，作者将两个矿工的挖矿情况建模为随机迭代博弈。

与旨在提高玩家自身利润的典型策略不同，ZD策略用于控制对手结果在一定范围内，以避免低社会福利，即整个矿池的利润[69]。在这个游戏中，两个玩家是一个利他矿工，即试图最大化社会福利的矿工，和一个自私矿工，即只旨在提高其自身利润的矿工。他们的策略包括合作，即诚实挖矿，以及对另一个矿工发起BWH攻击。请注意，利他矿工和自私矿工根据对方在上一次迭代中选择的策略，以概率方式选择自己的策略。分析表明，只要利他矿工根据决定性函数（即与玩家利润因子相关的线性函数）应用策略，无论自私矿工采用何种策略，自私矿工的利润都在从相互合作到相互攻击的范围内。因此，利他矿工确实可以通过执行ZD策略激励自私矿工合作挖矿，从而限制自私矿工的利润，实现最高的社会福利。模拟结果显示，所提出的游戏可以实现比[35]中提出的矿池游戏更高的社会福利。然而，所提出的游戏没有考虑利他矿工的利润。这意味着利他矿工可能没有执行ZD策略的动机。

[50]中的两个矿池攻击者场景也可以在[56]中找到。然而，除了PBWH攻击之外，[56]的作者还考虑了矿工在矿池之间的迁移。特别是，一个矿池的矿工可以迁移到另一个矿池并发起PBWH攻击以增加利润。为了分析矿工的平均收益和矿工的随机迁移过程，[56]中采用了并发平均收益游戏（CMPG）。CMPG（见第三节）是一个具有有限状态空间的双玩家游戏，在每个状态，两个玩家同时选择他们的策略[46]。在这里，玩家是矿池1和矿池2，游戏的状态包括矿池1和矿池2迁移的矿工数量。一个矿池的策略是确定（i）其矿工迁移到另一个矿池的数量和（ii）执行PBWH攻击的矿工。迁移的矿工数量取决于另一个矿池的吸引力水平，即矿池总挖矿奖励与其矿工总计算能力的比率。如果一个矿池被另一个矿池的矿工渗透，该矿池的吸引力水平会下降。这种下降可以被整个区块链网络观察到，因此另一个矿池可以根据观察结果调整其迁移策略。通常，矿池的利润不仅取决于状态，即矿工迁移的分配，还取决于其选择的策略。实验结果表明，如果矿池1的矿工根据矿池2的吸引力水平随机迁移到矿池2，那么矿池2的平均收益目标，即平均利润，可以针对矿池1的任何策略得到保证。然而，在多玩家场景中，平均收益目标可能无法得到保证。这样的场景可以在未来的工作中进行研究。

上述方法，即[35]、[50]和[56]，仅限于两个矿池之间的互动。考虑到多矿池场景，[55]的作者采用计算能力分割（CPS）游戏[70]来模拟PBWH攻击。为了提高他们的预期收益，玩家，即拥有正计算能力的矿工或矿池，可以选择（i）攻击其他矿池，即将其计算能力分配给其他矿池并发起BWH攻击，以及（ii）诚实遵守或任意偏离矿池的协议。在玩家选择攻击的情况下，玩家的策略是确定（i）其计算能力的分配，以及（ii）其挖矿能力持有攻击的部分，如图5所示。目标是最大化玩家的利润，定义为从所有矿池收到的挖矿奖励的总和。对于其他矿工的任何给定策略，总存在一种计算能力分配，使矿工能够增加其利润并导致其他矿池损失。换句话说，诚实挖矿不是玩家的最佳回应，因此游戏没有纯纳什均衡策略。尽管如此，游戏有一个独特的混合策略均衡，其中每个玩家都有动机以概率方式发起PBWH攻击，而不是诚实挖矿。模拟结果显示，玩家的最佳策略是遵守以下规则。首先，玩家发起提高其利润的PBWH攻击。其次，攻击者将计算能力用于PBWH攻击的比例不超过特定分数，以获得比诚实挖矿更多的利润。最后，攻击者应该攻击大矿池而不是小矿池。[35]和[55]的工作从不同角度得出了一些一致的发现。

![image-20240602172712863](C:/Users/daijunhao/AppData/Roaming/Typora/typora-user-images/image-20240602172712863.png)

上述讨论的方法，即[35]和[55]，仅考虑了挖矿奖励。实际上，比特币系统还提供了交易费[1]。当区块创建奖励主导挖矿奖励时，矿工可能不会立即向其他人广播交易，以增加他们的预期利润[71]。这被称为自私传播攻击。为了应对这种攻击，[57]的作者提出了一种激励机制，鼓励矿工传播交易。所提出的机制设计为，每个矿工根据其在传播过程中的行为从区块链系统获得传播奖励（见第二节-B）。为了最大化获得的传播奖励，每个矿工根据其他矿工的策略配置，策略性地选择复制自己（即在转发交易之前添加虚假身份）或立即转发交易。矿工之间的互动可以建模为非合作博弈，如[57]中所述。在游戏中，玩家是意识到交易的矿工。每个玩家不仅策略性地转发交易，还进行工作量证明（PoW）。授权玩家，即解决PoW的玩家，以及与授权玩家在同一中继链上的玩家获得一定的奖励。其他玩家一无所获。这种情况在图6中进行了说明。通过使用迭代移除占优策略[12]，证明了游戏存在唯一的纳什均衡。在纳什均衡点，只有交易传播和不复制策略（即纳什均衡策略）在移除占优策略后存活。然而，如果没有足够的玩家相互连接，就不能保证防止自私传播攻击。

![image-20240602172724973](C:/Users/daijunhao/AppData/Roaming/Typora/typora-user-images/image-20240602172724973.png)

其他关于理解没有挖矿奖励的传播机制漏洞的工作也可以在[28]、[72]、[73]中找到。[33]的作者证明，仅凭区块创建奖励，就足以吸引矿工扩展拥有最多可用交易费的区块，而不是遵循最长链。每个矿工都打算积极地分叉链的头部，并选择性地留下未认领的交易以最大化其利润。这种攻击被称为削减攻击，执行削减攻击的矿工被称为削减者。这种情况在图7中进行了说明，其中“选项二”对应于削减攻击。如果矿工执行削减策略，如果其区块最终不在最长链上，它可能一无所获。削减者策略性地执行削减策略，以吸引其他矿工在分叉链上挖矿。同时，其他矿工考虑是否在分叉链上挖矿以最大化他们的利润。因此，矿工之间的互动可以建模为重复游戏，在每个挖矿阶段，每个矿工选择执行诚实挖矿或削减。博弈论分析表明，如果矿工的削减策略遵循某个函数以最大化区块大小，那么该策略也是所有矿工的最佳回应。这是在矿工分叉时必须执行削减的约束下。因此，纳什均衡存在，所有矿工采用相同的削减策略。模拟结果显示，当每个矿工应用无遗憾学习算法时，即使有66%的矿工诚实挖矿，削减也比诚实挖矿更有利可图。因此，可能会有许多未认领的交易被留下，这对整个区块链网络是有害的。[74]通过非博弈论方法也得出了相同的结论。然而，如果模拟考虑网络延迟，削减者可能有足够的时间将所有交易包含在区块中，因此削减者没有动机将任何交易留给下一个矿工。

![image-20240602172818618](C:/Users/daijunhao/AppData/Roaming/Typora/typora-user-images/image-20240602172818618.png)

与矿池之间的攻击不同，[58]中介绍了一种在执行按最后N个份额支付（PPLNS）[75]的挖矿池内部进行的自私挖矿攻击的变体。PPLNS是一种流行的矿池挖矿奖励机制。与在当前轮次中将区块奖励分配给矿池中的矿工不同，PPLNS将奖励分配给在最近的PPLNS窗口中已经提交份额的矿工。PPLNS窗口包括连续提交的份额，最近的份额是PoW的完整解决方案。具体来说，PPLNS窗口中的份额被视为有效份额。提交有效份额的矿工根据其在所有有效份额中的比例获得奖励。在这种机制下，矿工可能会发起延迟攻击。在延迟攻击中，矿工首先延迟提交份额，即通过持有已发现的份额，如果矿工找到了PoW的解决方案，矿工会释放所有延迟的份额，然后立即提交解决方案。因此，由于在最近的PPLNS窗口中份额的比例更高，可以获得更多的奖励。这种情况在图8中进行了说明。

对于同一矿池中的每个矿工，挖矿过程中有两个阶段。在第一阶段，矿工只收集用于延迟的份额。在第二阶段，矿工立即提交每个份额，即通过诚实挖矿。为了最大化发起延迟攻击的预期利润，每个矿工需要根据其他矿工的策略选择合适的时间过渡其阶段。否则，矿工可能会失去其所有延迟份额的奖励。因此，[58]的作者将同一矿池中矿工之间的互动建模为非合作博弈。证明了如果最强大的矿工的计算能力满足一定条件，纳什均衡存在。这个条件与PPLNS窗口大小和找到PoW解决方案的复杂性有关。在纳什均衡点，矿池中的每个矿工都处于两个阶段之间的转折点。这意味着矿工没有偏离诚实挖矿的动机，因此矿工不会延迟其份额。这样的矿池被称为激励兼容矿池。模拟结果显示，如果矿池不是激励兼容的，尽管延迟矿工的比例随着与窗口大小和解决PoW复杂性相关的参数而减少，无论权力分布如何，游戏都无法达到纳什均衡。

![image-20240602172855001](C:/Users/daijunhao/AppData/Roaming/Typora/typora-user-images/image-20240602172855001.png)